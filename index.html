<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>APLSLâ€“SBT Patient Support Portal  </title>

<style>
:root{
  --brand:#1b8ea6;
  --bg:#d2c4f2;
  --card:#ffffff;
  --text:#0f172a;
  --muted:#475569;
  --danger:#dc2626;
  --ok:#065f46;
}

body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
  background:linear-gradient(180deg,#f7fbff,#eef5ff);
  color:var(--text);
}

.wrap{max-width:1000px;margin:auto;padding:24px}

.card{
   background: linear-gradient(135deg, #eaf4ff, #dbeafe);
  border:1px solid #e5e7eb;
  border-radius:16px;
  padding:20px;
  box-shadow:0 6px 20px rgba(0,0,0,.08);
  margin-bottom:16px;
}

h1{margin:0 0 10px}
h2{margin:0 0 14px}

label{
  display:block;
  font-size:13px;
  margin-bottom:6px;
  color:var(--muted);
  font-weight:600;
}

/* ðŸ”¹ Alignment improvement for Name & Mobile placeholders */
input[type="text"],
input[type="tel"],
input[type="email"]{
  width:100%;
  padding:12px 14px;
  border-radius:10px;
  border:1px solid #d1d5db;
  font-size:14px;
  box-sizing:border-box;
}

input::placeholder{
  color:#9ca3af;
  font-size:13px;
}

.grid{display:grid;gap:16px}
@media (min-width:860px){ .grid-2{grid-template-columns:1fr 1fr} }

.row{display:flex;gap:12px;flex-wrap:wrap}

.btn{
  border:none;
  border-radius:12px;
  padding:12px 18px;
  font-weight:700;
  cursor:pointer;
}

.btn-primary{background:var(--brand);color:white}
.btn-danger{background:var(--danger);color:white}

.status{margin-top:12px;font-size:14px}
.status.ok{color:var(--ok)}
.status.err{color:var(--danger)}

.medBox{
  margin-top:18px;
  border:1px solid #e5e7eb;
  border-radius:14px;
  padding:14px;
  background:#fbfdff;
}

.medScroll{
  height:420px;
  overflow:auto;
  overflow-x:auto;
  overflow-y:auto;
  overscroll-behavior: contain;
  border-radius:12px;
  border:1px solid #e5e7eb;
  background: rgba(255,255,255,0.50);
}

table{
  width:max-content;
  min-width:1250px;
  border-collapse:collapse;
}

th,td{
  padding:10px;
  border-bottom:1px solid #e5e7eb;
  font-size:13px;
}

th{
  background: rgba(241,245,249,0.65);
  position:sticky;
  top:0;
}

.right{text-align:right}
.qty{width:90px}
.uom{width:110px}

.req{color:var(--danger);font-weight:bold}

.note{
  margin-top:10px;
  font-size:12px;
  color:var(--muted);
}

.na-badge{
  display:inline-block;
  background:#e6f6fa;
  color:#1b8ea6;
  border:1px solid #1b8ea6;
  padding:4px 10px;
  border-radius:999px;
  font-weight:800;
  font-size:12px;
  letter-spacing:.2px;
}


/* ===== Logo cards (side-by-side) ===== */
.logo-row{
  display:flex;
  gap:14px;
  flex-wrap:wrap;
  align-items:stretch;
  margin-top:14px;
}
.logo-card{
  flex:1 1 280px;
  border:1px dashed #cbd5e1;
  border-radius:14px;
  padding:14px;
  background:#ffffff;
  display:flex;
  align-items:center;
  gap:12px;
}
.logo-card img{
  height:56px;
  width:auto;
  max-width:160px;
  object-fit:contain;
  display:block;
}
.logo-card .logo-text{
  line-height:1.2;
}
.logo-card .logo-title{
  font-weight:800;
  color:var(--text);
}
.logo-card .logo-sub{
  font-size:12px;
  color:var(--muted);
  margin-top:4px;
}

/* ===== Select Medicines background image ===== */
#medicineSection{
  position:relative;
  background: url('asset/images/ORDER FORM.png') center center / cover no-repeat;
  border-radius:14px;
  overflow:hidden;
}
#medicineSection::before{
  content:"";
  position:absolute;
  inset:0;
  background: rgba(255,255,255,0.40); /* overlay (more image visibility) */
  z-index:0;
}
#medicineSection > *{
  position:relative;
  z-index:1;
}


/* ===== Medicine search ===== */
.medSearchRow{
  display:flex;
  gap:10px;
  align-items:center;
  margin:10px 0 12px;
  flex-wrap:wrap;
}
.medSearchRow input[type="text"]{
  flex:1 1 320px;
}
.smallHint{
  font-size:12px;
  color:var(--muted);
}
#medSearch{
  background: rgba(255,255,255,0.60);
  border: 1px solid #11799A;
}

</style>
</head>

<body>
<div class="wrap">

<div class="card">
<h1>Ahanitya Pharma Life Science LLP</h1>
<h2> Patient Care Support Web Portal </h2>
<div class="note">Attachment + Selected Medicines + Quantity are compulsory for email submission.</div>
<div class="note" style="color:#dc2626;font-weight:700;">ðŸšš Service Available in Ahmedabad City Only.</div>


<div class="logo-row">
  <div class="logo-card">
    <img src="asset/images/LOGO.png" alt="Logo 1">
    <div class="logo-text">
      <div class="logo-title">Ahanitya Pharma Life Science LLP</div>
      <div class="logo-sub"> </div>
    </div>
  </div>

  <div class="logo-card">
    <img src="asset/images/sky biotec h image.PNG" alt="Logo 2">
    <div class="logo-text">
      <div class="logo-title">Sky Biotech </div>
      <div class="logo-sub"> </div>
    </div>
  </div>
</div>

</div>

<form id="ecForm"
      action="https://formsubmit.co/infoahanityapharmalifescellp@gmail.com"
      method="POST"
      enctype="multipart/form-data"
      class="card">

<input type="hidden" name="_captcha" value="false">
<input type="hidden" name="_subject" value="APLSL End Consumer Order">
<input type="hidden" name="_template" value="table">
<input type="hidden" name="_cc" value="skybiotech.var@gmail.com">

<h2>SBTâ€“APLSL Patient Care Order Form </h2>

<div class="grid grid-2">
  <div>
    <label>Name <span class="req">*</span></label>
    <input type="text" name="Consumer Name" id="custName" placeholder="Enter Full Name" required>
  </div>
  <div>
    <label>Mobile No <span class="req">*</span></label>
    <input type="tel" name="Mobile No" id="custMobile" placeholder="Enter 10-digit Mobile No" required>
  </div>
</div>

<div class="grid grid-2" style="margin-top:14px;">
  <div>
    <label>City <span class="req">*</span></label>
    <input type="text" name="City" id="custCity"
           placeholder="Enter City (Service Available in Ahmedabad Only)" required>
  </div>
  <div>
    <label>Area / Locality (Optional)</label>
    <input type="text" name="Area / Locality" placeholder="Eg: Bopal, Maninagar, Satellite">
<div style="margin-top:14px;">
  <label>Google Map Location Link</label>
  <div style="display:flex;align-items:center;gap:8px;">
    <input type="url" 
           name="Google Map Location Link" 
           placeholder="Paste Google Maps Location Link (Eg: https://maps.app.goo.gl/xxxxx)"
           style="flex:1;">
    <div onclick="window.open('https://maps.google.com','_blank')" 
         title="Open Google Maps"
         style="width:42px;height:42px;display:flex;align-items:center;justify-content:center;
                background:#ffffff;border:1px solid #d1d5db;border-radius:10px;
                cursor:pointer;transition:.2s;">
      <img src="https://cdn-icons-png.flaticon.com/512/684/684908.png" 
           style="width:22px;height:22px;">
    </div>
  </div>
</div>

  </div>
</div>

<div class="grid grid-2" style="margin-top:14px;">
  <div>
    <label>End Consumer Mail ID</label>
    <input type="email" name="Consumer Email" placeholder="Enter Email (if available)">
  </div>
  <div>
    <label>Referred Doctor Name</label>
    <input type="text" name="Referred Doctor Name" placeholder="Doctor Name">
  </div>
</div>

<div class="grid grid-2" style="margin-top:14px;">
  <div>
    <label>Doctor Mobile No</label>
    <input type="tel" name="Doctor Mobile No" placeholder="Doctor Mobile Number">
  </div>
  <div>
    <label>Doctor Mail ID</label>
    <input type="email" name="Doctor Mail ID" placeholder="Doctor Email (if available)">
  </div>
</div>

<div style="margin-top:16px">
<label>Attach Prescription / Document <span class="req">*</span></label>
<input type="file" name="Attachment" id="custFile"
accept=".pdf,.doc,.docx,.jpg,.jpeg,.png,.xls,.xlsx,.csv"
required>
</div>

<div class="medBox" id="medicineSection">
<h2>Select Medicines & Quantity <span class="req">*</span></h2>

<div class="medSearchRow">
  <input type="text" id="medSearch" placeholder="Search medicine by Brand or Company (e.g., AZIN or Ahanitya)">
  <span class="smallHint">Type to filter</span>
</div>

<div class="medScroll">
<table>
<thead>
<tr>
<th>Sr</th>
<th>Brand</th>
<th>Company</th>
<th>Product Type</th>
<th>Strength</th>
<th class="right">Qty</th>
<th class="right">Unit</th>
</tr>
</thead>
<tbody id="medBody"></tbody>
</table>
</div>
</div>
  
<div class="customMessageBox">
  <label for="customMessage"> Medicines Not Listed? Share Here </label>
  <textarea id="customMessage" name="custom_message" 
            placeholder="Enter any special instructions, notes, or message here..."
            rows="4"></textarea>
</div>
<textarea id="hiddenItems" name="Selected Medicines" style="display:none"></textarea>

<div class="row" style="margin-top:18px">
  <button type="button" class="btn btn-primary" onclick="sendBoth()">
    Submit Order
  </button>
</div>

<div id="status" class="status"></div>

</form>
</div>

<script>
const MEDICINES=[
    {Sr:1,   brand:"AZIN-500", company:"Ahanitya Pharma Life Science LLP", productType:"TAB", strength:"Azithromycin 500 mg", available:true},
  {Sr:2,   brand:"ASP", company:"Ahanitya Pharma Life Science LLP", productType:"TAB", strength:"Aceclofenac + Paracetamol + Serratiopeptidase", available:true},
  {Sr:3,   brand:"A-SUNAC", company:"Ahanitya Pharma Life Science LLP", productType:"TAB", strength:"Aceclofenac + Paracetamol", available:true},
  {Sr:4,   brand:"APLSL-DiaMet", company:"Ahanitya Pharma Life Science LLP", productType:"TAB", strength:"Glimepiride 2 mg + Metformin HCl (ER)", available:false},
  {Sr:5,   brand:"APLSL-Lulizid", company:"Ahanitya Pharma Life Science LLP", productType:"CREAM", strength:"Luliconazole 1%",  available:false},
  {Sr:6,   brand:"Ahanitya-Ketozin", company:"Ahanitya Pharma Life Science LLP", strength:"Ketoconazole 2%", productType:"SHAMPOO", available:false},
  {Sr:7,   brand:"APLSL-Cutiderm", company:"Ahanitya Pharma Life Science LLP", productType:"CREAM", strength:"Itraconazole 1% + Ofloxacin 0.75% + Ornidazole 2% + Clobetasol 0.05%", available:false},
  {Sr:8,   brand:"Ahanitya-AmbroLev", company:"Ahanitya Pharma Life Science LLP", productType:"TAB", strength:"Ambroxol 60mg + Levocetirizine 2.5mg + Paracetamol 500mg + Phenylephrine 5mg", available:false},
  {Sr:9,   brand:"PANTO-DSR", company:"Ahanitya Pharma Life Science LLP", productType:"CAP", strength:"Pantoprazole + Domperidone",  available:true},
  {Sr:10,  brand:"LE-MONT", company:"Ahanitya Pharma Life Science LLP", productType:"TAB", strength:"Montelukast + Levocetirizine",  available:true},

   
];

// âœ… Persist selections even after filtering/re-render
// Keyed by brand (unique). Stores qty + unit.
const selectionState = new Map();
function getKey(m){ return (m.brand || "").trim(); }
function ensureState(m){
  const k = getKey(m);
  if(!selectionState.has(k)){
    selectionState.set(k, { qty: 0, unit: "Box" });
  }
  return selectionState.get(k);
}

function renderRows(){
  const tbody = document.getElementById("medBody");
  if(!tbody) return;

  const searchEl = document.getElementById("medSearch");
  const q = (searchEl && searchEl.value ? searchEl.value : "").trim().toLowerCase();

  tbody.innerHTML = "";

  const filtered = MEDICINES.filter(m => {
    if(!q) return true;
    const brand = (m.brand || "").toLowerCase();
    const company = (m.company || "").toLowerCase();
    const strength = (m.strength || "").toLowerCase();
    const ptype = (m.productType || "").toLowerCase();
    return brand.includes(q) || company.includes(q) || strength.includes(q) || ptype.includes(q);
  });

  filtered.forEach((m) => {
    const tr = document.createElement("tr");
    const state = ensureState(m);

    const qtyCellHTML = (m.available === false)
      ? `<span class="na-badge">Updating Soon</span>`
      : `<input type="number" min="0" step="1" value="${state.qty}" class="qty" inputmode="numeric" data-key="${getKey(m)}">`;

    const unitCellHTML = (m.available === false)
      ? `<span class="na-badge">â€”</span>`
      : `<select class="uom" data-key="${getKey(m)}">
           <option value="Box">Box</option>
           <option value="Strip">Strip</option>
           <option value="Bottle">Bottle</option>
           <option value="Each">Each</option>
         </select>`;

    // Sr no based on original list position (stable)
    const sr = MEDICINES.findIndex(x => getKey(x) === getKey(m)) + 1;

    tr.innerHTML = `
      <td>${sr}</td>
      <td>${m.brand}</td>
      <td>${m.company || ""}</td>
      <td>${m.productType || ""}</td>
      <td>${m.strength}</td>
      <td class="right">${qtyCellHTML}</td>
      <td class="right">${unitCellHTML}</td>
    `;

    tbody.appendChild(tr);

    // Set selected unit after adding row
    const uom = tr.querySelector(".uom");
    if(uom){ uom.value = state.unit || "Box"; }
  });

  // Attach listeners AFTER rows are added (so filtering doesn't break selection)
  tbody.querySelectorAll("input.qty").forEach((el)=>{
    el.addEventListener("input", ()=>{
      const key = el.getAttribute("data-key");
      const v = Number(el.value || 0);
      const st = selectionState.get(key) || { qty: 0, unit: "Box" };
      st.qty = Number.isFinite(v) ? Math.max(0, Math.floor(v)) : 0;
      selectionState.set(key, st);
    });
  });

  tbody.querySelectorAll("select.uom").forEach((el)=>{
    el.addEventListener("change", ()=>{
      const key = el.getAttribute("data-key");
      const st = selectionState.get(key) || { qty: 0, unit: "Box" };
      st.unit = el.value || "Box";
      selectionState.set(key, st);
    });
  });
}

function collectItems(){
  let text = "";
  MEDICINES.forEach((m)=>{
    const key = getKey(m);
    const st = selectionState.get(key);
    if(!st || !st.qty || st.qty <= 0) return;
    if(m.available === false) return; // just in case
    const brand = (m.brand || "").trim();
    const company = (m.company || "").trim();
    const strength = (m.strength || "").trim();
    const unit = (st.unit || "Box").trim();
    const ptype = (m.productType || "").trim();
    text += `${brand} - ${company}${ptype ? " ["+ptype+"]" : ""} (${strength}) - ${st.qty} ${unit}
`;
  });
  return text.trim();
}

document.getElementById("ecForm").addEventListener("submit",function(e){
  const cityEl = document.getElementById("custCity");
  const city = (cityEl && cityEl.value ? cityEl.value.trim().toLowerCase() : "");
  if(city !== "ahmedabad"){
    e.preventDefault();
    document.getElementById("status").textContent = "Currently service is available in Ahmedabad only.";
    document.getElementById("status").className = "status err";
    return;
  }
  const items = collectItems();
  if(!items){
    e.preventDefault();
    document.getElementById("status").textContent = "Please select at least one medicine with quantity.";
    document.getElementById("status").className = "status err";
    return;
  }
  document.getElementById("hiddenItems").value = items;
  document.getElementById("status").textContent = "Sending to email...";
  document.getElementById("status").className = "status ok";
});

function sendBoth(){
  const form = document.getElementById("ecForm");

  // Ahmedabad validation (unchanged)
  const cityEl = document.getElementById("custCity");
  const city = (cityEl && cityEl.value ? cityEl.value.trim().toLowerCase() : "");
  if(city !== "ahmedabad"){
    alert("Currently service is available in Ahmedabad only.");
    return;
  }

  // Medicines validation
  const items = collectItems();
  if(!items){
    alert("Please select at least one medicine with quantity.");
    return;
  }
  document.getElementById("hiddenItems").value = items;

  // Basic required validation
  const name = document.getElementById("custName").value.trim();
  const mobile = document.getElementById("custMobile").value.trim();
  if(!name || !mobile){
    alert("Fill Name and Mobile No first.");
    return;
  }

  // Attachment required for email (as per your note)
  const fileEl = document.getElementById("custFile");
  if(fileEl && fileEl.required && (!fileEl.files || !fileEl.files.length)){
    alert("Please attach prescription/document before submitting.");
    return;
  }

  // Build WhatsApp message from ALL form fields (similar to email/table)
  const fd = new FormData(form);

  // Remove internal FormSubmit keys from message
  const skipKeys = new Set(["_captcha","_subject","_template","_cc","Selected Medicines"]);
  // Attachment: cannot be sent via WhatsApp, but we include file name
  const attachmentName = (fileEl && fileEl.files && fileEl.files[0]) ? fileEl.files[0].name : "";

  const lines = [];
  lines.push("APLSL End Consumer Order");
  lines.push(`Date: ${new Date().toLocaleString()}`);
  lines.push("");

  // Order details fields in a neat order (match your form labels)
  const orderedFields = [
    "Consumer Name",
    "Mobile No",
    "Consumer Email",
    "City",
    "Area / Locality",
    "Google Map Location Link",
    "Referred Doctor Name",
    "Doctor Mobile No",
    "Doctor Mail ID"
  ];

  lines.push("Order Details:");
  orderedFields.forEach((k)=>{
    if(skipKeys.has(k)) return;
    const v = (fd.get(k) || "").toString().trim();
    lines.push(`${k}: ${v ? v : "-"}`);
  });

  if(attachmentName){
    lines.push(`Attachment (sent on email): ${attachmentName}`);
  }else{
    lines.push("Attachment (sent on email): -");
  }

  lines.push("");
  lines.push("Medicines:");
  lines.push(items);

  const message = encodeURIComponent(lines.join("\n"));

  // Submit Email first
  form.submit();

  // Then open WhatsApp
  window.open(`https://wa.me/918487090212?text=${message}`,"_blank");
}

document.addEventListener("DOMContentLoaded", () => {
  renderRows();
  const s = document.getElementById("medSearch");
  if(s){ s.addEventListener("input", renderRows); }
});
</script>

<p>Â© 2026 Ahanitya Pharma Life Science LLP. All Rights Reserved.  
Developed by APLSL.</p>
</body>
</html>
